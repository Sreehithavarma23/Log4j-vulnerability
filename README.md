# Log4j-vulnerability

- Build image using docker ```docker build -t log4jpwn .```
- Then Run the container using ``` docker run --rm -p8080:8080 log4jpwn```
- Make a curl request with a poisoned User-Agent header with your payload 

---------------------------------------------------------------------------------------------------------------------------------------------------------------
- Create a servlet that handles incoming HTTP requests and logs the data containing the malicious payload. This servlet will simulate the behavior of receiving data from the user and logging it.
```
LogServlet.java

import java.io.IOException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet("/log")
public class LogServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;
    private static final Logger logger = Logger.getLogger(LogServlet.class.getName());

    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String userData = request.getParameter("data");
        logger.log(Level.INFO, "Received data from user: {0}", userData);
    }
}
```
- Compile the servlet code and package it into a WAR file along with the required web.xml deployment descriptor file. Deploy the WAR file to the webapps directory of Apache Tomcat.
- Ensure that Apache Tomcat is running and accessible on localhost.
- Send data to the servlet using a tool like cURL. Include the malicious payload in the request body.
- Check the logs of Apache Tomcat to verify that the malicious payload has been logged. The logs are typically located in the logs directory of your Tomcat installation.
```
Web.xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
         version="4.0">
    <servlet>
        <servlet-name>LogServlet</servlet-name>
        <servlet-class>com.example.LogServlet</servlet-class> <!-- Adjust the package and class name as needed -->
    </servlet>
    <servlet-mapping>
        <servlet-name>LogServlet</servlet-name>
        <url-pattern>/log</url-pattern> <!-- Adjust the URL pattern as needed -->
    </servlet-mapping>
</web-app>
```
